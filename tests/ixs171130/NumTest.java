package ixs171130;

import org.junit.jupiter.api.Test;

import java.util.Arrays;
import java.util.EmptyStackException;
import java.util.NoSuchElementException;

import static org.junit.jupiter.api.Assertions.*;

class NumTest {
    @Test
    void testStringConstructorWithDefaultBase() {
        // testing for a multiple of base
        Num x = new Num("10000");
        assertEquals("1000000000: 10000", x.returnListAsString());
        assertEquals("10000", x.toString());

        // testing for a small number
        x = new Num("100");
        assertEquals("1000000000: 100", x.returnListAsString());
        assertEquals("100", x.toString());

        // testing with more zeroes
        x = new Num("100000000000");
        assertEquals("1000000000: 0 100", x.returnListAsString());
        assertEquals("100000000000", x.toString());

        // testing for a (small) non-multiple of the base
        Num y = new Num("567");
        assertEquals("1000000000: 567", y.returnListAsString());
        assertEquals("567", y.toString());

        // testing for a (long) non-multiple of the base
        Num z = new Num("45895361142");
        assertEquals("1000000000: 895361142 45", z.returnListAsString());

        // testing for negative number
        Num a = new Num("-1");
        assertEquals("1000000000: 1", a.returnListAsString());
        assertTrue(a.isNegative);

        // testing for a large negative number
        Num b = new Num("-12546731");
        assertEquals("1000000000: 12546731", b.returnListAsString());
        assertTrue(b.isNegative);

        // large number with single digits in middle
        b = new Num("1015578");
        assertEquals("1000000000: 1015578", b.returnListAsString());
        assertEquals("1015578", b.toString());
        assertFalse(b.isNegative);

        // testing for zero
        Num c = new Num("0");
        assertEquals("1000000000: 0", c.returnListAsString());

        // long string of zeroes
        Num d = new Num("00000000000");
        assertEquals("1000000000: 0", d.returnListAsString());
    }

    @Test
    void testLongConstructorWithDefaultBase() { // add bigger numbers
        // testing for a multiple of a base
        Num x = new Num(10000);
        assertEquals("1000000000: 10000", x.returnListAsString());

        // testing for a small non-multiple of base
        x = new Num(57);
        assertEquals("1000000000: 57", x.returnListAsString());
        assertFalse(x.isNegative);

        // testing for a small negative number
        x = new Num(-5);
        assertEquals("1000000000: 5", x.returnListAsString());
        assertTrue(x.isNegative);

        // testing for a large negative number
        x = new Num(-6589423);
        assertEquals("1000000000: 6589423", x.returnListAsString());
        assertTrue(x.isNegative);

        // testing for 0
        x = new Num(0);
        assertEquals("1000000000: 0", x.returnListAsString());
        assertFalse(x.isNegative);

        // largest long possible
        x = new Num(9223372036854775807L);
        assertEquals("1000000000: 854775807 223372036 9", x.returnListAsString());
        assertFalse(x.isNegative);
        assertEquals("9223372036854775807", x.toString());

        // smallest possible long
        x = new Num(-9223372036854775807L);
        assertEquals("1000000000: 854775807 223372036 9", x.returnListAsString());
        assertTrue(x.isNegative);
        assertEquals("-9223372036854775807", x.toString());
    }

    @Test
    void testStringConstructorExceptions() {
        // nothing passed
        assertThrows(ArithmeticException.class, () -> {
            Num a = new Num("");
        });
    }

    @Test
    void testAdd() {
        Num x, y, result;

        // add two zeroes
        x = new Num(0);
        y = new Num(0);
        result = Num.add(x, y);
        assertEquals("0", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);

        // add two small numbers
        x = new Num(123);
        y = new Num("4567");
        result = Num.add(x, y);
        assertEquals("4690", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);


        // add two large numbers
        x = new Num("15248695712464651165");
        y = new Num("125485784");
        result = Num.add(x, y);
        assertEquals("15248695712590136949", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);

        // add a positive and a negative number
        x = new Num("1");
        y = new Num("-1");
        result = Num.add(x, y);
        assertEquals("0", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);

        // add a positive and a negative number
        x = new Num("340282366920938463463374607431768211456");
        y = new Num("-1");
        result = Num.add(x, y);
        assertEquals("340282366920938463463374607431768211455", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);

        // add HUGE numbers
        x = new Num("38751659661118868378801805060560750618956004954420780687454447426067254023361904353879716806318072303632004901872622065474757661484076076463412607769016728305461123159982915326562770671339246330315370310983606835801639765924688765699120562639895559322085244405382127426522422716938287626862653660807590713624169056795241831460396841890769792371429502964019775390625");
        y = new Num("34143115322784228849944935551113819944806873883247339368564776954250143409");
        result = Num.add(x, y);
        assertEquals("38751659661118868378801805060560750618956004954420780687454447426067254023361904353879716806318072303632004901872622065474757661484076076463412607769016728305461123159982915326562770671339246330315370310983606835801639765924688765699120562639895559322085244405382127426522422716938287626862687803922913497853019001730792945280341648764653039710798067740974025534034", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);

        // add first number negative, second positive
        x = new Num("-1");
        y = new Num("1");
        result = Num.add(x, y);
        assertEquals("0", result.toString());
        assertFalse(result.isNegative);
        assertEquals(1000000000L, result.base);
    }

    @Test
    void testSubtractionWhenNumbersAreEqual() {
        Num x, y, result;

        // subtract 0 from 0
        x = new Num(0);
        y = new Num("0");
        result = Num.subtract(x, y);
        assertEquals("0", result.toString());

        // subtract two equal +ve numbers
        x = new Num(100);
        y = new Num("100");
        result = Num.subtract(x, y);
        assertEquals("0", result.toString());

        // subtract two equal -ve numbers
        x = new Num("-123456789");
        y = new Num(-123456789);
        result = Num.subtract(x, y);
        assertEquals("0", result.toString());
    }

    @Test
    void testSubtractionWhenXIsGreaterThanY() {
        Num x, y, result;

        // testing when y is zero
        x = new Num("460");
        y = new Num(0);
        result = Num.subtract(x, y);
        assertEquals("460", result.toString());
        assertFalse(result.isNegative);

        // when x is positive and y is negative, with a smaller number
        x = new Num("5");
        y = new Num("-3");
        result = Num.subtract(x, y);
        assertEquals("8", result.toString());

        x = new Num("100000000000");
        y = new Num(9);
        result = Num.subtract(x, y);
        assertEquals("99999999991", result.toString());

        x = new Num("100000000000");
        y = new Num(1);
        result = Num.subtract(x, y);
        assertEquals("99999999999", result.toString());

        // when x is positive and y is negative, with a large number
        x = new Num("15248597586485754648891564");
        y = new Num("-48915198495619845641984");
        result = Num.subtract(x, y);  // 15297512784981374494533548
        assertEquals("15297512784981374494533548", result.toString());
        assertFalse(result.isNegative);

        // when x and y both are negative
        x = new Num("-15");
        y = new Num("-30");
        result = Num.subtract(x, y);
        assertEquals("15", result.toString());
        assertFalse(result.isNegative);

        // when x and y are both negative, differ by 1
        x = new Num("-16");
        y = new Num("-17");
        result = Num.subtract(x, y);
        assertEquals("1", result.toString());
        assertFalse(result.isNegative);

        // when x and y both are negative, large numbers
        x = new Num("-152485618");
        y = new Num("-15949549846514987951598798484987");
        result = Num.subtract(x, y);
        assertEquals("15949549846514987951598645999369", result.toString());
        assertFalse(result.isNegative);

        // when x and y are both positive
        x = new Num("15249846519841321984984");
        y = new Num("15489156949841897");
        result = Num.subtract(x, y);
        assertEquals("15249831030684372143087", result.toString());
        assertFalse(result.isNegative);

        // x, y both positive, with smaller number
        x = new Num(10);
        y = new Num(9);
        result = Num.subtract(x, y);
        assertEquals("1", result.toString());
        assertFalse(result.isNegative);
    }

    @Test
    void testSubtractionWhenYIsGreaterThanX() {
        Num x, y, result;

        // testing when x is zero
        x = new Num(0);
        y = new Num(460);
        result = Num.subtract(x, y);
        assertEquals("-460", result.toString());
        assertTrue(result.isNegative);

        // with a smaller number
        x = new Num(-5);
        y = new Num("3");
        result = Num.subtract(x, y);
        assertEquals("-8", result.toString());
        assertTrue(result.isNegative);

        // with large numbers
        x = new Num("-54787498494159798465456465498168798165498465198798465");
        y = new Num("549879851894548978951987891489789459549545594554564");
        result = Num.subtract(x, y);
        assertEquals("-55337378346054347444408453389658587625048010793353029", result.toString());
        assertTrue(result.isNegative);

        // when both are positive
        x = new Num(10);
        y = new Num(20);
        result = Num.subtract(x, y);
        assertEquals("-10", result.toString());
        assertTrue(result.isNegative);

        // when both are positive, large numbers
        x = new Num("4854894654984651978964598798444");
        y = new Num("65469849468489484749654897894151654651654654656");
        result = Num.subtract(x, y);
        assertEquals("-65469849468489479894760242909499675687055856212", result.toString());
        assertTrue(result.isNegative);

        // edge case
        x = new Num(685050);
        y = new Num(1234567);
        result = Num.subtract(x, y);
        assertEquals("-549517", result.toString());
        assertTrue(result.isNegative);

        // when both are positive, with only 1 digit more in second
        x = new Num("4564984351654321894132165743516546546");
        y = new Num("45649843516543218941321657435165465462");
        result = Num.subtract(x, y);
        assertEquals("-41084859164888897047189491691648918916", result.toString());
        assertTrue(result.isNegative);

        // when both are negative
        x = new Num("-4519816518498165496546");
        y = new Num("-959849465");
        result = Num.subtract(x, y);
        assertEquals("-4519816518497205647081", result.toString());

        // when both are negative, small difference
        x = new Num("1234567");
        y = new Num("925925");
        result = Num.subtract(x, y);
        assertEquals("308642", result.toString());
        //result.printList();
        //System.out.println(" len " + result.len);
        assertFalse(result.isNegative);
    }

    @Test
    void testSubtractWithLargeNumbers() {
        Num x, y, result;

        // subtract two large numbers, both ways
        x = new Num("33611141580816492842483407931259094246356138012487074041247823444945272516226885640710916958365023962831114257540237");
        y = new Num("868961758838235800287756364471948378335796838288975942380290688618631629298190451688200804595799187620583691268029782284423459421328787441070241643294159775050113833420284747674478527063285036001");
        result = Num.subtract(x, y);
        assertEquals("-868961758838235800287756364471948378335796838288975942380290688618631629298190418077059223779306345137175760008935535928285446934254746193246796698021643548164473122503326382650515695949027495764",
                result.toString());
        assertTrue(result.isNegative);
        result = Num.subtract(y, x);
        assertEquals("868961758838235800287756364471948378335796838288975942380290688618631629298190418077059223779306345137175760008935535928285446934254746193246796698021643548164473122503326382650515695949027495764",
                result.toString());
        assertFalse(result.isNegative);

        // subtract two negative numbers
        x = new Num("-22838422686555587263948685490152318882035472844501809360976087896337614957874991896849190676558796921891771164421806480340889836627951616");
        y = new Num("-40159526927620481646000322676629816996929091843685756139806942025541935596108702291164656468513971532274808851070702075958251953125");
        result = Num.subtract(x, y);
        assertEquals("-22838382527028659643467039489829642252218475915409965675219948089395589415939395788146899511902328407920238889612955409638813878375998491", result.toString());
        assertTrue(result.isNegative);
        result = Num.subtract(y, x);
        assertEquals("22838382527028659643467039489829642252218475915409965675219948089395589415939395788146899511902328407920238889612955409638813878375998491", result.toString());
        assertFalse(result.isNegative);

        // one negative, one positive number
        x = new Num("53010368591190628480063130338422958370577432613813872637115298871391407445502614942050612115961368925873910378570017882469581789454073574272995355910643655165347617893769670964933586368499639693628623698705481149589913578377142082315597873441");
        y = new Num("-15081278524875458459524077327366935184409295858957501168008577210113539611260640924935990839015017504565177128962418871388530154553971913742205812306709276699443677230682801881879072144182675717519005159470861087589068693746909");
        result = Num.subtract(x, y);
        assertEquals("53010368591190643561341655213881417894654759980749057046411157828892575454079825055590223376602293861864749393587522447646710751872944962803149909882557397371159924603046370408610817051301521572700767881381198668595073049238229671384291620350", result.toString());
        assertFalse(result.isNegative);
        result = Num.subtract(y, x);
        assertEquals("-53010368591190643561341655213881417894654759980749057046411157828892575454079825055590223376602293861864749393587522447646710751872944962803149909882557397371159924603046370408610817051301521572700767881381198668595073049238229671384291620350", result.toString());
        assertTrue(result.isNegative);
    }

    @Test
    void testProduct() {
        Num x, y, z;

        x = new Num("123");
        y = new Num("456");
        z = Num.product(x, y);
        assertEquals("56088", z.toString());
        assertFalse(z.isNegative);

        x = new Num("0");
        y = new Num("456");
        z = Num.product(x, y);
        assertEquals("0", z.toString());

        x = new Num("0");
        y = new Num("0");
        z = Num.product(x, y);
        assertEquals("0", z.toString());

        x = new Num("-123");
        y = new Num("456");
        z = Num.product(x, y);
        assertEquals("-56088", z.toString());
        assertTrue(z.isNegative);

        x = new Num("12");
        y = new Num("-456");
        z = Num.product(x, y);
        assertEquals("-5472", z.toString());
        assertTrue(z.isNegative);

        x = new Num("-123456789101112");
        y = new Num("-456784658437654366");
        z = Num.product(x, y);
        assertEquals("56393167241360975102138882254992", z.toString());
        assertFalse(z.isNegative);

        x = new Num("4567");
        y = new Num("1080246");
        z = Num.product(x, y);
        assertEquals("4933483482", z.toString());

        // x = 28 ^ 540
        // y = 13 ^ 84
        x = new Num("29196912262690298697045171071227564667260040436654339882287194485474630657870546367627144185053964113592547355970714484223912042291161019105640632371547944218880214849133181997332788158415772848396554915079645902880272442817043048898706769393688933879297149003809212636558877023082323564293874940872076386825171044682365925699065304114631792427532965213503105785220460814649755336659862797656305439311545983473599081661801698567091178877803907453943123722970372982525212624171439809484096979220883764380151628012762433570590302641717158112502015019542249883120121190308477019682449261590015817038256590322559842362019402535080261179511808499652544512915318827152110764198584811211481834406243372755960701878873305848159037654161095762525391821561330974600078914959432423289363890176");
        y = new Num("3725989217506060809913745704292352543926459628485989232909583897978821195955532381542525335761");
        z = Num.product(x, y);
        assertEquals("108787380275254537422337083407026541576926897494191558807982244178598088829595237192947277407770235863712469991693305062389297849503698887410432173943392683321434472115618165118613723850111997480286408022199417547898629700568548933149364301954599755641074294596849652317165881924486562945994213785472548960936498168683073779424624070113138364429776499280762341622224654906650875393660036532443332935781538469350188315122783260231740664223080760134775100975177519410083912906626686144110013382233627959394458285142743640869171387399096706084385244595160423488689360170424104886272860927913092260023619322662526822291094334930253525621243219137215628620600504763341730217438819615791150930258651370498419769189174473087059913470785708657517529888895005661010352338330135209410809565852629750724015623571966490634381842054470959371063186443247247513669451414347809633843529383936", z.toString());

        // making one number negative
        x.isNegative = true;
        z = Num.product(x, y);
        assertEquals("-108787380275254537422337083407026541576926897494191558807982244178598088829595237192947277407770235863712469991693305062389297849503698887410432173943392683321434472115618165118613723850111997480286408022199417547898629700568548933149364301954599755641074294596849652317165881924486562945994213785472548960936498168683073779424624070113138364429776499280762341622224654906650875393660036532443332935781538469350188315122783260231740664223080760134775100975177519410083912906626686144110013382233627959394458285142743640869171387399096706084385244595160423488689360170424104886272860927913092260023619322662526822291094334930253525621243219137215628620600504763341730217438819615791150930258651370498419769189174473087059913470785708657517529888895005661010352338330135209410809565852629750724015623571966490634381842054470959371063186443247247513669451414347809633843529383936", z.toString());
        assertTrue(z.isNegative);

        // making y also negative
        y.isNegative = true;
        z = Num.product(x, y);
        assertEquals("108787380275254537422337083407026541576926897494191558807982244178598088829595237192947277407770235863712469991693305062389297849503698887410432173943392683321434472115618165118613723850111997480286408022199417547898629700568548933149364301954599755641074294596849652317165881924486562945994213785472548960936498168683073779424624070113138364429776499280762341622224654906650875393660036532443332935781538469350188315122783260231740664223080760134775100975177519410083912906626686144110013382233627959394458285142743640869171387399096706084385244595160423488689360170424104886272860927913092260023619322662526822291094334930253525621243219137215628620600504763341730217438819615791150930258651370498419769189174473087059913470785708657517529888895005661010352338330135209410809565852629750724015623571966490634381842054470959371063186443247247513669451414347809633843529383936", z.toString());
        assertFalse(z.isNegative);

        // testing with a large number and a small one
        x = new Num("108787380275254537422337083407026541576926897494191558807982244178598088829595237192947277407770235863712469991693305062389297849503698887410432173943392683321434472115618165118613723850111997480286408022199417547898629700568548933149364301954599755641074294596849652317165881924486562945994213785472548960936498168683073779424624070113138364429776499280762341622224654906650875393660036532443332935781538469350188315122783260231740664223080760134775100975177519410083912906626686144110013382233627959394458285142743640869171387399096706084385244595160423488689360170424104886272860927913092260023619322662526822291094334930253525621243219137215628620600504763341730217438819615791150930258651370498419769189174473087059913470785708657517529888895005661010352338330135209410809565852629750724015623571966490634381842054470959371063186443247247513669451414347809633843529383936");
        y = new Num("5");
        z = Num.product(x, y);
        assertEquals("543936901376272687111685417035132707884634487470957794039911220892990444147976185964736387038851179318562349958466525311946489247518494437052160869716963416607172360578090825593068619250559987401432040110997087739493148502842744665746821509772998778205371472984248261585829409622432814729971068927362744804682490843415368897123120350565691822148882496403811708111123274533254376968300182662216664678907692346750941575613916301158703321115403800673875504875887597050419564533133430720550066911168139796972291425713718204345856936995483530421926222975802117443446800852120524431364304639565461300118096613312634111455471674651267628106216095686078143103002523816708651087194098078955754651293256852492098845945872365435299567353928543287587649444475028305051761691650676047054047829263148753620078117859832453171909210272354796855315932216236237568347257071739048169217646919680", z.toString());
        assertFalse(z.isNegative);
    }

    @Test
    void testCompareTo() {
        // testing with same numbers
        Num x, y;
        x = new Num("24536789456123");
        y = new Num("24536789456123");

        assertEquals(0, x.compareTo(y));

        // testing with one positive and one negative number
        x = new Num("24536789456123");
        y = new Num("-24536789456123");
        assertEquals(1, x.compareTo(y));

        // testing with one negative and one positive number
        x = new Num("-24536789456123");
        y = new Num("24536789456123");
        assertEquals(-1, x.compareTo(y));

        // testing with both negative numbers
        x = new Num("-24536789456123");
        y = new Num("-24536789456123");
        assertEquals(0, x.compareTo(y));

        // testing when first number is different length
        x = new Num("1548964165749845");
        y = new Num("145215");
        assertEquals(1, x.compareTo(y));

        // testing when second number is different length
        x = new Num("126453165");
        y = new Num("458198765165798435198794");
        assertEquals(-1, x.compareTo(y));

        // testing with different length numbers where one is +ve and one is -ve
        x = new Num("15894561984651");
        y = new Num("-5498124984231543516549846");
        assertEquals(1, x.compareTo(y));

        // just reverse of previous
        assertEquals(-1, y.compareTo(x));

        // both negative numbers
        x = new Num("-15489165987");
        y = new Num("-15489165987");
        assertEquals(0, x.compareTo(y));
        assertEquals(0, y.compareTo(x));

        // two zeroes
        x = new Num("0");
        y = new Num("0");
        assertEquals(0, x.compareTo(y));
        assertEquals(0, y.compareTo(x));

        // two negative numbers smaller than base
        x = new Num("-15");
        y = new Num("-30");
        assertEquals(1, x.compareTo(y));
        assertEquals(-1, y.compareTo(x));

        // one positive, one negative. Both smaller than base
        x = new Num("15");
        y = new Num("-30");
        assertEquals(1, x.compareTo(y));
        assertEquals(-1, y.compareTo(x));

        x = new Num("-152485618");
        y = new Num("-15949549846514987951598798484987");
        assertEquals(1, x.compareTo(y));
        assertEquals(-1, y.compareTo(x));
    }

    @Test
    void testToString() {
        // zero!
        Num x = new Num(0);
        assertEquals("0", x.toString());

        // negative number
        x = new Num("-15981587984132549845216879841321063846321068949684");
        assertEquals("-15981587984132549845216879841321063846321068949684", x.toString());

        // a large random number
        x = new Num("1123446891891879512198946152197987494");
        assertEquals("1123446891891879512198946152197987494", x.toString());
    }

    @Test
    void testBy2() {
        Num x, y, z;

        x = new Num("1234567891234567891230");
        assertEquals("617283945617283945615" , x.by2().toString());

        x = new Num("123456789123456789123456789123456789123456789");
        assertEquals("61728394561728394561728394561728394561728394" , x.by2().toString());

        x = new Num(0);
        assertEquals("0", x.by2().toString());

        x = new Num("-256");
        assertEquals("-128", x.by2().toString());
    }

    @Test
    void testDivide() {
        Num x, y, z;

        x = new Num("123456789");
        y = new Num("4567");
        assertEquals("27032", Num.divide(x, y).toString());

        x = new Num("-123456789");
        y = new Num("4567");
        assertEquals("-27032", Num.divide(x, y).toString());

        x = new Num("123456789");
        y = new Num("-4567");
        assertEquals("-27032", Num.divide(x, y).toString());

        x = new Num("-123456789");
        y = new Num("-4567");
        assertEquals("27032", Num.divide(x, y).toString());

        x = new Num("0");
        y = new Num("-4567");
        assertEquals("0", Num.divide(x, y).toString());

        x = new Num("-4567");
        y = new Num("0");
        assertNull(Num.divide(x, y));

        x = new Num("0");
        y = new Num("0");
        assertNull(Num.divide(x, y));

        // x = 97 ^ 99
        // y = 85 ^ 67
        x = new Num("49023204046810063052865617754531993076026071520903088968920741451572890340395967569520426628951284340118127138453851707836951742337890127232804456106417984709109735388024795899433618241972372230433");
        y = new Num("1866672041827527715527831152271703341950348043011081482789361986997870193300504817874555137102721147357442532666027545928955078125");
        z = Num.divide(x, y);
        assertEquals("26262355115585746494653955611056081647313202578455754479708388427586", z.toString());

        z = Num.divide(y, x);
        assertEquals("0", z.toString());
    }

    @Test
    void testPower() {
        Num x, z;
        Long y;
        x = new Num(97);
        y = 99L;
        z = Num.power(x, y);
        assertEquals("49023204046810063052865617754531993076026071520903088968920741451572890340395967569520426628951284340118127138453851707836951742337890127232804456106417984709109735388024795899433618241972372230433", z.toString());

        x = new Num(10);
        y = 0L;
        z = Num.power(x, y);
        assertEquals("1", z.toString());

        x = new Num("85");
        y = 67L;
        z = Num.power(x, y);
        assertEquals("1866672041827527715527831152271703341950348043011081482789361986997870193300504817874555137102721147357442532666027545928955078125", z.toString());

        // putting y as largest Long possible, because why not?
        x = new Num("1");
        y = 9223372036854775807L;
        z = Num.power(x, y);
        assertEquals("1", z.toString());

        x = new Num("0");
        y = 9223372036854775807L;
        z = Num.power(x, y);
        assertEquals("0", z.toString());

        x = new Num(2);
        y = 10000L;
        z = Num.power(x, y);
        assertEquals("19950631168807583848837421626835850838234968318861924548520089498529438830221946631919961684036194597899331129423209124271556491349413781117593785932096323957855730046793794526765246551266059895520550086918193311542508608460618104685509074866089624888090489894838009253941633257850621568309473902556912388065225096643874441046759871626985453222868538161694315775629640762836880760732228535091641476183956381458969463899410840960536267821064621427333394036525565649530603142680234969400335934316651459297773279665775606172582031407994198179607378245683762280037302885487251900834464581454650557929601414833921615734588139257095379769119277800826957735674444123062018757836325502728323789270710373802866393031428133241401624195671690574061419654342324638801248856147305207431992259611796250130992860241708340807605932320161268492288496255841312844061536738951487114256315111089745514203313820202931640957596464756010405845841566072044962867016515061920631004186422275908670900574606417856951911456055068251250406007519842261898059237118054444788072906395242548339221982707404473162376760846613033778706039803413197133493654622700563169937455508241780972810983291314403571877524768509857276937926433221599399876886660808368837838027643282775172273657572744784112294389733810861607423253291974813120197604178281965697475898164531258434135959862784130128185406283476649088690521047580882615823961985770122407044330583075869039319604603404973156583208672105913300903752823415539745394397715257455290510212310947321610753474825740775273986348298498340756937955646638621874569499279016572103701364433135817214311791398222983845847334440270964182851005072927748364550578634501100852987812389473928699540834346158807043959118985815145779177143619698728131459483783202081474982171858011389071228250905826817436220577475921417653715687725614904582904992461028630081535583308130101987675856234343538955409175623400844887526162643568648833519463720377293240094456246923254350400678027273837755376406726898636241037491410966718557050759098100246789880178271925953381282421954028302759408448955014676668389697996886241636313376393903373455801407636741877711055384225739499110186468219696581651485130494222369947714763069155468217682876200362777257723781365331611196811280792669481887201298643660768551639860534602297871557517947385246369446923087894265948217008051120322365496288169035739121368338393591756418733850510970271613915439590991598154654417336311656936031122249937969999226781732358023111862644575299135758175008199839236284615249881088960232244362173771618086357015468484058622329792853875623486556440536962622018963571028812361567512543338303270029097668650568557157505516727518899194129711337690149916181315171544007728650573189557450920330185304847113818315407324053319038462084036421763703911550639789000742853672196280903477974533320468368795868580237952218629120080742819551317948157624448298518461509704888027274721574688131594750409732115080498190455803416826949787141316063210686391511681774304792596709376", z.toString());

        x = new Num(29);
        y = 15816L;
        z = Num.power(x, y);
        assertEquals("193523972324579978525340950181185952544879980984620210365456896261195605545641018665063626366593031803854053150340391562433078076250171726337329173030063204274151829904955691781214089982842538456115119516298134165159712675356179008886234091882645016961040158064264852275107218077853134640214478608740710579037154787967948109751700267416398548034247752957631440233372245183981018138817519759882447652786592223270196571890316691186630153372609813670025413945319395736565246046058400840919288550726113977594101819063858224785695095588042211787875477738030858214114055926913759892798180864414487905957928887596679808920425380013217910838908667048670619800842888973149758517268831132593449445114694376494986821440174296730392968605370814425002796882216720731745648828250254567225329257724304923941908973667370664655984882525854827738592953950535577008905402883108237700473624094161105588733900581077653517107146082308896028817973461394848630998678149897725893858379333927398660020264627197309247751502641048045338776427926671689342744253226636007826157205658479670205715810353772379632012553762415627510571868761758898845861391007656859310316906482564691921688450720048577419926615368697554335353608097798663412869106372218814665603112082171428986674984234439417202834497412402659769269847488402454440465374199478852523720190182906808002770173122958520791875633110285638770731447846878517774068810933537965826714629901630615065507626758360730839834149475239178469171168775814452228070431990730496436132779633957569833029480405087826082206443978775549791967118876207980232101035848293932266727751114611494107388611879183243756334104832417640475528212739461834890148116278908381308031719987076921084776166341787100563865885973336356243051621246265475413512327382777542672346475914701054726135435742186620081465920065608376031263831759689992122606239720619489544864235962033354415546770354227081701335455467914273831903250744486719734377229183810568856087169116520892462320090361519790230018032050227856790055345195292707089841695992761876006510475535834165476628258422063472652072995182985048260870937071551003954840730960347342712870982035534598547631795867973504005052367156526395779604533222515622806948362584119677041373919911145021015173896574432150191337468494827090437929286704194629666686780082142069597271898109843968534546756985672741253390227672382967137866955627278979541944249788897809779115133790148352878852866814424565972609984960300678466997364797520873280381636992988297492677003770161446069657755694791284025701087811341341056554240882776030527876322000998556838989639135726527680889402097584974066413961381948412775467593306537037471369058020257949964322588422941012681469994586118251728133284719367945532308606776488540246252057581071652949103375642242551064899848397636618004141092976425139240116633712180978503702706055546819774548240019939358337340038592842767339360333607188099434121607872104932332884901615032219967114721968277766889730460947662190945318212574771310751826941131948371171169672938691002758692877177451409175690773974308779623377121260031096984927480739143527735729103337041453907126480805865968600976458341569547761122204094732018552468572418416476342609334936670749147004226411909012370338362372365636911703441801458813610114722248240742534749918721738574942798739017039576420820744271761983274215949581928280621683406738763525942900762129342582953973556448288713683069994327216613713401058780931956131486532640886738086279297759453372798632377041430428304924326016509709004046036047534731631512534017773044380307289004497836879733343405491094616211672144638328845950288904093440644142386533858141008500983704772021851887175869793827353303155365622530327227828445489000421997391216217897388104012279694660380677651342977560435282743516598008361504490527619258122843240008692374142415081707362713314582692942513231391205495489357539375482853461514975636321218324640850947085531930799130646639368273117994709187874673167706926404595339573944092308756343854357053671186699420153516712633551018136984876623980252068795069907583964077317036240913811936271790654127655178094724035785170641890872416666626834626852200537634444790961384305080735373508213862461238486414336390254881824789550631094503624070816083024234188220597030781481092155498460721221344950584165008883883733940436736500331707769578146831626942150849852224584901884308072714419251114715208039722128030628249261560889800319326805680604715813389431368450849411782500895150519681850204996585349458175056964671546115507772991295130814302490649710003145104280252699983716426064466304162534208009175733452448229605367597743009838682524104171543756316007983568763596058695670474430446390906465813057281873226497514117860410118453137818306545917030893266724276788557485263936353878589721624849498839711740487679661588884787539301674711459072111130177569495851582468161293081452768814680906588204996463363591088242590085870100869497242240367690348074003749534211117269109122460101411396175634251235051236879629076176526659912175988231021546137264483458885482615326102637688744410947094999302752424567702079192820965677994507581263261237643013388559811991595064130807193134082715572574525881245518436691967945417279716783853096256311562648991522018349322544293317560203845822822860808189352490314810917848096131008540177662633598464413660480021648709735372923453594403295321442119393675224774752353778991439089402208573030622766979578248674549979639457944370379635661092334254771269004896407832887625925197262149942365280955711376370895821702434809984853424719198361806508858797484706652296962830816037951865905719177030909100017387122454127043234478348917414007751710581930812625502295513733139379401751605293495242451482253548587104671921772457964818759006076328128408374348268788742002612711928673326867059576462858225250131582617820041450291920808131208079706173677687908772438217259741503143584820897885203605137596278965138390485915039461130509236884610772448403064742592892340021189730999268560996508693760070166552977972701474800184418755223458688432454584570506661024124884546341640243909412570786995316053072212553195307286669543032877225139249946004332449763735690373893437703683746765500139627382833405824475736127286696118854819831058793129632240729445995249232829519419529569541702019124037138463869041252661133892019813141042563575131291941014835784429651156210084175901145929682223134766370831863915433196972518475147421204848902749324588339959186997549453230128161054771586300617542513738786542097614772573791093130294332203006225478235346647100298773598901815910598053058164666947129718075482629374082719058576638602582034589694376290851136761541727610567576207345012684145780878313682293520929613295788829215404893649876191696179956325177534991663349381076369285948048660025259331779446766857100937384889543695176605751220978156908704304808475327118898462262163989968584840649174572213586102571275044347344570012809813520578650515859642093505264532626591482356577811533550108907699361967754017771200016813452523828473683391870928746859474220173194237485087921071884157846058150221159668846235392939341778855470670650465026138550410422435348794548063595280353582921778915065337361823287657489398985974694303100718480181188920460577937789126975212112138868329386478280037469223433303627856075283599681485455173259811068021640948685308885177406906602533825728354744455188114386917762321449871937056247445451191137794209171793219618335751512953640029467811797045993876263931931925685685929584123922543557464431314637075337050056040168303904856308316018635914778206822553304133346810854354778814319636464097735171109578175641567455600568955974005891151810462425764426077695509635534092058262137593077038831537391347615161532485004811721970165129110053617391507396408175040446950558565765744866026569662073830954301457881571058533035472965931769018188768154281095052976994948896228014114780916878943819789504464834959937332459733305676066987486863757685930604713194565398043354687888880298421671909303613329772287960872901458407854097213941948381665544318118466905878286920829958448750010755461218564934705597401749286479533072039265946576743537664162901237740337722644298036313379898420486290734130791921456733975266534846599042506328972301440613302403671650506879843393572973325030648234299429268078102762379801801564008180477142434955572049843691759637215011031084476285629630920615870641373121775712789402231455109972273094867909238442589020186438773770941801011200856224516295400500355510364513527768417752117315079753191107806169259543253051449308040513879235352189427502584907339756666290661659140320184157730613446088773433996484603332127550664409610705954042512000269063315036300097135624303926989675710017895082030223126345781159091171508150524113725885850113554043973096659759790968222041967103649565349924775770331450520582205386774198727292426732133260585729470831480370947137671942218259753295360244111039114921867904927625793338549043963837523534205212253116441342665701221622738209282323771772006805110803440382234872040426043251648841732416931619069330297151836285031021407457709550531155713311509987483098863560267501170507669451523004604885382027898995943542385884889809930826709250470376476499510957581173452046184700640235710533145918383591029890933006059713286870279201984423443604170044022321437978241599265430579413240793059329931697852976315052003323137614285658863791599130540871754405442838666085753316628597322173054802384714291946193347552002330535389291665543688267967627517251122189627855222502366522648196011424158640856787629146090874436196305476641291175659456489058163566110479944170167519230753072423872429723363341845254515177898371461342271550993945197947362459884981048428452352357203932831685450465856247224664155565043024787439973184800488096603503629234258203713842356984964728323739018890640363594912375737946664930654971444386045685149921925836909828324914624319044715798134388213700792976631985048695727145459122701289529474303890294460492427718323825038781439462386820433692368020436232887560188361354881424356492373044939225505676949528855641034240916400170711521350624510522769194348760671156028333017826096640173932379965344995001242173681084364672721693303054950738130160539634612465496140320467039782402431357821722587766117272557973407816155706417859507243381155084146504770974596569091793404177047358420584499810929245468287896504004147214677845633423515774787729409239353428855241484523164818369423246428852879307004197122086357156963021984591941944835097722482671238408859918200625060457831147603192147711816316896380047909073160229080674560982070565772718147403988131121844639359951992962641223050683191885677508773470747302458288058201333227043424441965747039539818031691858646211973168486846907846692136737235981521174232372902485640560158453858396209978000640585882465558541100322281151617416082953543650666290435608926403832604626053665850955412091246166926547550218662313643566403761791620109274354980189516834800532847054972939019047853080138964509075658619424485618447786123834762344078031182961558706329881005876901302542843175404722949940466489584822184077871143346550998040795057172023626849525299015409004248525652172589498000311239904402505711234182185403140741674849138085004259362220424078259314445422367355928265025158632339871962609783357736311787732501149608411708517818791568932659756551902627436842504634676280947450273033629687735746918865218444829703419037398852420470273463300713767629878803040922853145411446264066469430320963268469093888208882199547304687046934169616852623386821593197515564817278043669878051821898818503979692388884556835813453417269904358495023300798057170443987576496250102645536298369033453640150403991576680197113303708373162328185942216453107026129071646429941662763259049869507540046090346521213551209290816676650407228658934518144866850709628570453754324601003670792858328406516740043437342896880031911483146013479641544052404806180749340590196991046111598904454148343099566987945020786519811105086581429313603455099888874851824856027266614436445204469053356186307651578738492543945475795842670454003290348116447982180400900314105689983094495436641068742286585216233761896909103004020536083698191789808893889661228285881332123022542495283742252927539441506223142018288735128140247347842520116815344658922691676185903404663618108043083774375458779384058315669423043174361115565412876480544201964019906302121316412181864977160063484191671905607059431308204382204631996808633030917223991836977280599068864649183485516301542862336003264182717512121722587917369250622781910736498765003405026098287099036657279078617742440570080474433262138037102627067049034808752586586142028544239478265596314535278202636503582971013898426653009780712311260984403477090513731578125856676714253288755306596882699454557588182823427873448845535718689980508913396482521851890227987781862525660589792359211112871658431688994891880367828209298320536908735694047081865852413219906221309377736288900873435412226560577203680381355405590171485142043209236839461044202697210825481904484488566926927683781503645035239528091752088761610396686237617686968963363935882346477731019061474190080606628482897712415565722339021205926623496160932600366719321879725408170525262036672348454307683147789807479055528531980490555455679023259538907069578646523576475288207830125969394405329118637509084500690164064224580405560696047205191115215483188097363534890984708572100742826326310033560457551865935666137052953283844950880115608970540015916559059007206840333566448314514343786734405784606117762838231462552031968734297187007418747632432857611485312683196426247087904997394301073287535451062936895332396778587033405408248489134156874267053202067241724150424390726398860292534344873567521101805993451220948909947278575655892474841273586828809851654811315015738701723966878394284535287513429751680430318833713860360955928530615001982435423596734599738147957210231989503009735000371033864042137618633415618077978876921070941982959582814655019931335606300967583163554333525329839175745003941346363655309364134441255028586185982204388908449731971781940990321758620262435949609097350663013340228269812370053292467689593583307640244037856553115906373718731617157583367391263575075357191065471972880940929327612332016398975801612888390925046541809332240390527745665793979246898562479857639811824824126956126212292469960956773381752410060602142811907742455400255261919811789700619005083559586578072927970543211401852001558671691570840705540410153541053791023933300378395940715487075320791922136828901476240457358041131985379749363335233668270901186334853241355878838754661328648763694882070315232621360524526350353669711429655353455148367892371429411011198188580508435535420426192152916481787267578434227717103091311704433978422183869040485840382294084500615547037751618346076021216991777548948322595894775417114308325029262632683766059849092896156495541280015720356319302399060073916385338510667193006973662934353846999210837570454626905867522465516365528479992326984589976118448507322953014349836975590593782420480384877496985684743699690581278412429372573544976185427026144898690657761397785589436752873175548450892451265134588848784405274316949536529514991568536172895432256266682612240375065184599426214004342736986996422294114936770153751577778006611413324998148188698710671167687760822504043498312738961400548647795279689676886317010829422832193822534179870813831479404315724357259738702221747628773119345222482489441908975738261388528259090585400557285460056988979838717920861531159807501038096948681963317437976186992006505080319316032355617614912893487187730278238685182649411123875718493616108497813210370097702627245744675511233882061203297212313791812507056988242067643706564927063833757379236420720005288589363837382913852036133306448373325143148670017537721082958118791416785403766918172554329647081710277635383052886387813373412294232587583757629697795406621190036106295310398574038039319409220268683975734524535061702960008094549177776390501351667444394640399965407037742555612927042535081934072662553278999642531742339021027157590839142974995373720584343881070651393892861722634634255686301605715874091360345741771510292928616836900553224717726980358433508495026752564236785392501459638978836403723297155863111810726304274158845918112047568302170748925369273272020885601785459963344600950929618854613418175827286710616143316917635418108258632138736569159847790428141501924817453420679314166520105354616092567007306827428271036886796429892779287977312918915239566579391661895785990223638781101470547220720948510882172962938306543398184748733043469933264458413772597822759195247857928463162483479123068031715023519056601480905586456848533815885822305725768255789559865482006593080680257375381669491886323851829274910351069777352887018600218456937700522623849250633151202717623541694708827622909537636960619982238661484987774587760034459645200537517588465978209116227287653792318912548606478278615648896649544889927306799242419089743116565973665648802972550366188345289713546125076222636180634183503141152957830700528568640329558845877174983123803554777050213496538528951022656729205638824327948784372929816924320705327336116628278001308612164363091146763700527546130465073679152086997976904011937810787438449821409878352502539969788313341609147093900917954984441638015652565134504869237215782727903304832583970039311189975886353968052340531092299944294503281844180536376595355469961617753396671961142880008969867564459274860403781649624088650118718459481222286107603507485523696737039766216399501557921384195715878736961940311874896994843955464949689074132684493788041795343603116161270793713184055535251805116988880970628532976830463759738396022499140199938305357228723600917244293788381508389414329827088860431323374162164244892005008798155769727670082754822870952660367527532572278007686146467618114399332158214485152034751186177773678496411811705743594570676244770118826143725668994683705128703900968977335069479479228006657917508602421534768451200684215252137678326775027490979642638004917719943421735595710663905643860150507871685586810535284282183325093462548447692321644694630878667016564891495652817504910124172852766783368153553114893943004221811478389166744942994025043792402219304747330263611097374200965576987674302946884540669580757667672116346302518275193317753192143513481059855903448065417225723758693144202306919462008980031762235896595681426505649801658731622679005065812272197337918372803943296012576982414601615706410023395407341934745848014512174261909915567216530256731863146014425350687630794353467308628096432828017666281327850754404549479570208116709438985078483796118830960495651456593680633713801978909445836064876770947794192174792437379077873446983479737895815600425921317112657401533627926332937822345215018886763269598083214218558653553417350081257245150705630617603234908124098358947806338032459875491019652071458024752901596823155231089292251789309213892376885684525561350431325689639083229260726765058483470097119537161316125683288857759357599514881708019533383008323649589985952127700328460233876494601567729231330050605322656564747326241808351337796381631575569854040189536201524088928208976853830958578533843617573330960094777188180395417092769503805044938423698180797638461643453871423014748967026750345857130141839512350124291450022918595254428999150936546327275860064449866994010199231251226507780281941769772681446899292133728681142181901780975441655042421830073445461448900852935043965531787480988344398240442363528754323543597160502115655981215862312393017400472638225449663736641592597509834655958655254644874351604062768157791799047318880899706848001055312706718782415013907826736006845174732210467504826009322049866568117200678441219013661424771796947324158830277465317584704384469611872546261370374241493466344158964964284010809862744478939828109163488797836847841895264791029172440942037176490101031679812432196141590135765814588383747300199701155188308839709379015822653144867035756426359638575481804242404573095216432508698892562603971694681788165457493320879368524367328715800480465357372651458341237138790519183463550105729891203893267887563242189157646653779231948430921001363043375685673825855698059480030689975917101070466401843259257811590805972289022532956759475151298140593182308175900093909846542143937799225227957022609340870241248921510460172409017652299938311528895613426515752059559688466140799924608245554535932161187040190587393029507209089591271998513342782057326947637862466367913295657438211309560600630089650073340426537664041345942188008973409531463784021814420766009766465602506883322835948993086486449140101062906166006834188085327235631990339526531113652887514639786898540765806126645129659219719619014187930512701051515926029927090205054142884841473136758297208690909231596907583474793236864251084543067965158581721345726904901153653572385556288237864791226122755432102787059305786295786231275642983910792086078887667555172297128588856784581220621091852427525662224763635276990202303342542314755128799585237101391287955332176610006743513661652552142485261398899068608861528861844349370374694823846427749010701611080527036186070715680555564882608725959575217916814250022247934187051067904276996131102341343524896679787152494792796967330002714403442347507039782017238883350010545734660761015692256058324938105093112059154470232302880811065397783631069922129975630983735537011164009289578393194820642542162578788984913344198140286573442397256710478350485814880154675955691977928161179777400750523871606698749997270828908965462327384179344831647818217387851721023886703320770228121555615847575921487478267136353868601551110699405926006067864290334087727888058925687303576376273919215330017190169373555473325163478820319247014386527016108419917587807663675291308366666842337134144210182873864406114572444018623794890023077565980553387080106398386132185794940984756691974716997391178747896369685970238801804698166595335836337645311413500968369113384235072478981778788697632471427415840660595803465496504866444698796607595040951172071620347936041079300563020961281011683681687902202981613323750373152515529271348058469227323098383097345116864742736487613531920976947737729232208272264719685120200573794452439407955582483301901777748947385942337534698352467408205956575277489921182063859493073555052782556089609656944085709853801716675531325994141162076205478384799485889565590466069550968507945630437600588708935557053228751011341311097786369316896235038474181474698049826056347677690769448953085007678987355301475900416187368050212176068837959115227908910755433693124814490623936844351558616927071139523735922793162375524969423961350214155513068975449113457385326022208696479378423309173905896971714821130421509739370684510313136053365280043303668554832443564996020006515500933982819148647526748656272208320816724214209448284261150691152367993602360278569516879184083222361187309131639211118705910301859840765636562822192401461671281816222023155782273691996167388561452244417388293205475639444024919703027557929058240611399293097254634501660106584993305653380333010602221520572927673003823521", z.toString());

//        x = new Num(2);
//        y = 10000000L;
//        z = Num.power(x, y);
//        assertEquals("", z.toString());
    }

    @Test
    void testSquareRoot() throws Exception {
        Num x, y;

        x = new Num(4);
        y = Num.squareRoot(x);
        assertEquals("2", y.toString());

        x = new Num(10);
        y = Num.squareRoot(x);
        assertEquals("3", y.toString());

        x = new Num(932663405025L);
        y = Num.squareRoot(x);
        assertEquals("965745", y.toString());

        x = new Num(9223372036854775807L);
        y = Num.squareRoot(x);
        assertEquals("3037000499", y.toString());

        x = new Num("7237005577332262210834635695349653859421902880380109739573089701262786560001");
        y = Num.squareRoot(x);
        assertEquals("85070591730234615847396907784232501249", y.toString());

        x = new Num(0);
        y = Num.squareRoot(x);
        assertEquals("0", y.toString());

        final Num z = new Num(-198);
        assertThrows(Exception.class, () -> {
            Num.squareRoot(z);
        });


        // keep this one commented, unless you want a long running loop!
//        x = new Num("193523972324579978525340950181185952544879980984620210365456896261195605545641018665063626366593031803854053150340391562433078076250171726337329173030063204274151829904955691781214089982842538456115119516298134165159712675356179008886234091882645016961040158064264852275107218077853134640214478608740710579037154787967948109751700267416398548034247752957631440233372245183981018138817519759882447652786592223270196571890316691186630153372609813670025413945319395736565246046058400840919288550726113977594101819063858224785695095588042211787875477738030858214114055926913759892798180864414487905957928887596679808920425380013217910838908667048670619800842888973149758517268831132593449445114694376494986821440174296730392968605370814425002796882216720731745648828250254567225329257724304923941908973667370664655984882525854827738592953950535577008905402883108237700473624094161105588733900581077653517107146082308896028817973461394848630998678149897725893858379333927398660020264627197309247751502641048045338776427926671689342744253226636007826157205658479670205715810353772379632012553762415627510571868761758898845861391007656859310316906482564691921688450720048577419926615368697554335353608097798663412869106372218814665603112082171428986674984234439417202834497412402659769269847488402454440465374199478852523720190182906808002770173122958520791875633110285638770731447846878517774068810933537965826714629901630615065507626758360730839834149475239178469171168775814452228070431990730496436132779633957569833029480405087826082206443978775549791967118876207980232101035848293932266727751114611494107388611879183243756334104832417640475528212739461834890148116278908381308031719987076921084776166341787100563865885973336356243051621246265475413512327382777542672346475914701054726135435742186620081465920065608376031263831759689992122606239720619489544864235962033354415546770354227081701335455467914273831903250744486719734377229183810568856087169116520892462320090361519790230018032050227856790055345195292707089841695992761876006510475535834165476628258422063472652072995182985048260870937071551003954840730960347342712870982035534598547631795867973504005052367156526395779604533222515622806948362584119677041373919911145021015173896574432150191337468494827090437929286704194629666686780082142069597271898109843968534546756985672741253390227672382967137866955627278979541944249788897809779115133790148352878852866814424565972609984960300678466997364797520873280381636992988297492677003770161446069657755694791284025701087811341341056554240882776030527876322000998556838989639135726527680889402097584974066413961381948412775467593306537037471369058020257949964322588422941012681469994586118251728133284719367945532308606776488540246252057581071652949103375642242551064899848397636618004141092976425139240116633712180978503702706055546819774548240019939358337340038592842767339360333607188099434121607872104932332884901615032219967114721968277766889730460947662190945318212574771310751826941131948371171169672938691002758692877177451409175690773974308779623377121260031096984927480739143527735729103337041453907126480805865968600976458341569547761122204094732018552468572418416476342609334936670749147004226411909012370338362372365636911703441801458813610114722248240742534749918721738574942798739017039576420820744271761983274215949581928280621683406738763525942900762129342582953973556448288713683069994327216613713401058780931956131486532640886738086279297759453372798632377041430428304924326016509709004046036047534731631512534017773044380307289004497836879733343405491094616211672144638328845950288904093440644142386533858141008500983704772021851887175869793827353303155365622530327227828445489000421997391216217897388104012279694660380677651342977560435282743516598008361504490527619258122843240008692374142415081707362713314582692942513231391205495489357539375482853461514975636321218324640850947085531930799130646639368273117994709187874673167706926404595339573944092308756343854357053671186699420153516712633551018136984876623980252068795069907583964077317036240913811936271790654127655178094724035785170641890872416666626834626852200537634444790961384305080735373508213862461238486414336390254881824789550631094503624070816083024234188220597030781481092155498460721221344950584165008883883733940436736500331707769578146831626942150849852224584901884308072714419251114715208039722128030628249261560889800319326805680604715813389431368450849411782500895150519681850204996585349458175056964671546115507772991295130814302490649710003145104280252699983716426064466304162534208009175733452448229605367597743009838682524104171543756316007983568763596058695670474430446390906465813057281873226497514117860410118453137818306545917030893266724276788557485263936353878589721624849498839711740487679661588884787539301674711459072111130177569495851582468161293081452768814680906588204996463363591088242590085870100869497242240367690348074003749534211117269109122460101411396175634251235051236879629076176526659912175988231021546137264483458885482615326102637688744410947094999302752424567702079192820965677994507581263261237643013388559811991595064130807193134082715572574525881245518436691967945417279716783853096256311562648991522018349322544293317560203845822822860808189352490314810917848096131008540177662633598464413660480021648709735372923453594403295321442119393675224774752353778991439089402208573030622766979578248674549979639457944370379635661092334254771269004896407832887625925197262149942365280955711376370895821702434809984853424719198361806508858797484706652296962830816037951865905719177030909100017387122454127043234478348917414007751710581930812625502295513733139379401751605293495242451482253548587104671921772457964818759006076328128408374348268788742002612711928673326867059576462858225250131582617820041450291920808131208079706173677687908772438217259741503143584820897885203605137596278965138390485915039461130509236884610772448403064742592892340021189730999268560996508693760070166552977972701474800184418755223458688432454584570506661024124884546341640243909412570786995316053072212553195307286669543032877225139249946004332449763735690373893437703683746765500139627382833405824475736127286696118854819831058793129632240729445995249232829519419529569541702019124037138463869041252661133892019813141042563575131291941014835784429651156210084175901145929682223134766370831863915433196972518475147421204848902749324588339959186997549453230128161054771586300617542513738786542097614772573791093130294332203006225478235346647100298773598901815910598053058164666947129718075482629374082719058576638602582034589694376290851136761541727610567576207345012684145780878313682293520929613295788829215404893649876191696179956325177534991663349381076369285948048660025259331779446766857100937384889543695176605751220978156908704304808475327118898462262163989968584840649174572213586102571275044347344570012809813520578650515859642093505264532626591482356577811533550108907699361967754017771200016813452523828473683391870928746859474220173194237485087921071884157846058150221159668846235392939341778855470670650465026138550410422435348794548063595280353582921778915065337361823287657489398985974694303100718480181188920460577937789126975212112138868329386478280037469223433303627856075283599681485455173259811068021640948685308885177406906602533825728354744455188114386917762321449871937056247445451191137794209171793219618335751512953640029467811797045993876263931931925685685929584123922543557464431314637075337050056040168303904856308316018635914778206822553304133346810854354778814319636464097735171109578175641567455600568955974005891151810462425764426077695509635534092058262137593077038831537391347615161532485004811721970165129110053617391507396408175040446950558565765744866026569662073830954301457881571058533035472965931769018188768154281095052976994948896228014114780916878943819789504464834959937332459733305676066987486863757685930604713194565398043354687888880298421671909303613329772287960872901458407854097213941948381665544318118466905878286920829958448750010755461218564934705597401749286479533072039265946576743537664162901237740337722644298036313379898420486290734130791921456733975266534846599042506328972301440613302403671650506879843393572973325030648234299429268078102762379801801564008180477142434955572049843691759637215011031084476285629630920615870641373121775712789402231455109972273094867909238442589020186438773770941801011200856224516295400500355510364513527768417752117315079753191107806169259543253051449308040513879235352189427502584907339756666290661659140320184157730613446088773433996484603332127550664409610705954042512000269063315036300097135624303926989675710017895082030223126345781159091171508150524113725885850113554043973096659759790968222041967103649565349924775770331450520582205386774198727292426732133260585729470831480370947137671942218259753295360244111039114921867904927625793338549043963837523534205212253116441342665701221622738209282323771772006805110803440382234872040426043251648841732416931619069330297151836285031021407457709550531155713311509987483098863560267501170507669451523004604885382027898995943542385884889809930826709250470376476499510957581173452046184700640235710533145918383591029890933006059713286870279201984423443604170044022321437978241599265430579413240793059329931697852976315052003323137614285658863791599130540871754405442838666085753316628597322173054802384714291946193347552002330535389291665543688267967627517251122189627855222502366522648196011424158640856787629146090874436196305476641291175659456489058163566110479944170167519230753072423872429723363341845254515177898371461342271550993945197947362459884981048428452352357203932831685450465856247224664155565043024787439973184800488096603503629234258203713842356984964728323739018890640363594912375737946664930654971444386045685149921925836909828324914624319044715798134388213700792976631985048695727145459122701289529474303890294460492427718323825038781439462386820433692368020436232887560188361354881424356492373044939225505676949528855641034240916400170711521350624510522769194348760671156028333017826096640173932379965344995001242173681084364672721693303054950738130160539634612465496140320467039782402431357821722587766117272557973407816155706417859507243381155084146504770974596569091793404177047358420584499810929245468287896504004147214677845633423515774787729409239353428855241484523164818369423246428852879307004197122086357156963021984591941944835097722482671238408859918200625060457831147603192147711816316896380047909073160229080674560982070565772718147403988131121844639359951992962641223050683191885677508773470747302458288058201333227043424441965747039539818031691858646211973168486846907846692136737235981521174232372902485640560158453858396209978000640585882465558541100322281151617416082953543650666290435608926403832604626053665850955412091246166926547550218662313643566403761791620109274354980189516834800532847054972939019047853080138964509075658619424485618447786123834762344078031182961558706329881005876901302542843175404722949940466489584822184077871143346550998040795057172023626849525299015409004248525652172589498000311239904402505711234182185403140741674849138085004259362220424078259314445422367355928265025158632339871962609783357736311787732501149608411708517818791568932659756551902627436842504634676280947450273033629687735746918865218444829703419037398852420470273463300713767629878803040922853145411446264066469430320963268469093888208882199547304687046934169616852623386821593197515564817278043669878051821898818503979692388884556835813453417269904358495023300798057170443987576496250102645536298369033453640150403991576680197113303708373162328185942216453107026129071646429941662763259049869507540046090346521213551209290816676650407228658934518144866850709628570453754324601003670792858328406516740043437342896880031911483146013479641544052404806180749340590196991046111598904454148343099566987945020786519811105086581429313603455099888874851824856027266614436445204469053356186307651578738492543945475795842670454003290348116447982180400900314105689983094495436641068742286585216233761896909103004020536083698191789808893889661228285881332123022542495283742252927539441506223142018288735128140247347842520116815344658922691676185903404663618108043083774375458779384058315669423043174361115565412876480544201964019906302121316412181864977160063484191671905607059431308204382204631996808633030917223991836977280599068864649183485516301542862336003264182717512121722587917369250622781910736498765003405026098287099036657279078617742440570080474433262138037102627067049034808752586586142028544239478265596314535278202636503582971013898426653009780712311260984403477090513731578125856676714253288755306596882699454557588182823427873448845535718689980508913396482521851890227987781862525660589792359211112871658431688994891880367828209298320536908735694047081865852413219906221309377736288900873435412226560577203680381355405590171485142043209236839461044202697210825481904484488566926927683781503645035239528091752088761610396686237617686968963363935882346477731019061474190080606628482897712415565722339021205926623496160932600366719321879725408170525262036672348454307683147789807479055528531980490555455679023259538907069578646523576475288207830125969394405329118637509084500690164064224580405560696047205191115215483188097363534890984708572100742826326310033560457551865935666137052953283844950880115608970540015916559059007206840333566448314514343786734405784606117762838231462552031968734297187007418747632432857611485312683196426247087904997394301073287535451062936895332396778587033405408248489134156874267053202067241724150424390726398860292534344873567521101805993451220948909947278575655892474841273586828809851654811315015738701723966878394284535287513429751680430318833713860360955928530615001982435423596734599738147957210231989503009735000371033864042137618633415618077978876921070941982959582814655019931335606300967583163554333525329839175745003941346363655309364134441255028586185982204388908449731971781940990321758620262435949609097350663013340228269812370053292467689593583307640244037856553115906373718731617157583367391263575075357191065471972880940929327612332016398975801612888390925046541809332240390527745665793979246898562479857639811824824126956126212292469960956773381752410060602142811907742455400255261919811789700619005083559586578072927970543211401852001558671691570840705540410153541053791023933300378395940715487075320791922136828901476240457358041131985379749363335233668270901186334853241355878838754661328648763694882070315232621360524526350353669711429655353455148367892371429411011198188580508435535420426192152916481787267578434227717103091311704433978422183869040485840382294084500615547037751618346076021216991777548948322595894775417114308325029262632683766059849092896156495541280015720356319302399060073916385338510667193006973662934353846999210837570454626905867522465516365528479992326984589976118448507322953014349836975590593782420480384877496985684743699690581278412429372573544976185427026144898690657761397785589436752873175548450892451265134588848784405274316949536529514991568536172895432256266682612240375065184599426214004342736986996422294114936770153751577778006611413324998148188698710671167687760822504043498312738961400548647795279689676886317010829422832193822534179870813831479404315724357259738702221747628773119345222482489441908975738261388528259090585400557285460056988979838717920861531159807501038096948681963317437976186992006505080319316032355617614912893487187730278238685182649411123875718493616108497813210370097702627245744675511233882061203297212313791812507056988242067643706564927063833757379236420720005288589363837382913852036133306448373325143148670017537721082958118791416785403766918172554329647081710277635383052886387813373412294232587583757629697795406621190036106295310398574038039319409220268683975734524535061702960008094549177776390501351667444394640399965407037742555612927042535081934072662553278999642531742339021027157590839142974995373720584343881070651393892861722634634255686301605715874091360345741771510292928616836900553224717726980358433508495026752564236785392501459638978836403723297155863111810726304274158845918112047568302170748925369273272020885601785459963344600950929618854613418175827286710616143316917635418108258632138736569159847790428141501924817453420679314166520105354616092567007306827428271036886796429892779287977312918915239566579391661895785990223638781101470547220720948510882172962938306543398184748733043469933264458413772597822759195247857928463162483479123068031715023519056601480905586456848533815885822305725768255789559865482006593080680257375381669491886323851829274910351069777352887018600218456937700522623849250633151202717623541694708827622909537636960619982238661484987774587760034459645200537517588465978209116227287653792318912548606478278615648896649544889927306799242419089743116565973665648802972550366188345289713546125076222636180634183503141152957830700528568640329558845877174983123803554777050213496538528951022656729205638824327948784372929816924320705327336116628278001308612164363091146763700527546130465073679152086997976904011937810787438449821409878352502539969788313341609147093900917954984441638015652565134504869237215782727903304832583970039311189975886353968052340531092299944294503281844180536376595355469961617753396671961142880008969867564459274860403781649624088650118718459481222286107603507485523696737039766216399501557921384195715878736961940311874896994843955464949689074132684493788041795343603116161270793713184055535251805116988880970628532976830463759738396022499140199938305357228723600917244293788381508389414329827088860431323374162164244892005008798155769727670082754822870952660367527532572278007686146467618114399332158214485152034751186177773678496411811705743594570676244770118826143725668994683705128703900968977335069479479228006657917508602421534768451200684215252137678326775027490979642638004917719943421735595710663905643860150507871685586810535284282183325093462548447692321644694630878667016564891495652817504910124172852766783368153553114893943004221811478389166744942994025043792402219304747330263611097374200965576987674302946884540669580757667672116346302518275193317753192143513481059855903448065417225723758693144202306919462008980031762235896595681426505649801658731622679005065812272197337918372803943296012576982414601615706410023395407341934745848014512174261909915567216530256731863146014425350687630794353467308628096432828017666281327850754404549479570208116709438985078483796118830960495651456593680633713801978909445836064876770947794192174792437379077873446983479737895815600425921317112657401533627926332937822345215018886763269598083214218558653553417350081257245150705630617603234908124098358947806338032459875491019652071458024752901596823155231089292251789309213892376885684525561350431325689639083229260726765058483470097119537161316125683288857759357599514881708019533383008323649589985952127700328460233876494601567729231330050605322656564747326241808351337796381631575569854040189536201524088928208976853830958578533843617573330960094777188180395417092769503805044938423698180797638461643453871423014748967026750345857130141839512350124291450022918595254428999150936546327275860064449866994010199231251226507780281941769772681446899292133728681142181901780975441655042421830073445461448900852935043965531787480988344398240442363528754323543597160502115655981215862312393017400472638225449663736641592597509834655958655254644874351604062768157791799047318880899706848001055312706718782415013907826736006845174732210467504826009322049866568117200678441219013661424771796947324158830277465317584704384469611872546261370374241493466344158964964284010809862744478939828109163488797836847841895264791029172440942037176490101031679812432196141590135765814588383747300199701155188308839709379015822653144867035756426359638575481804242404573095216432508698892562603971694681788165457493320879368524367328715800480465357372651458341237138790519183463550105729891203893267887563242189157646653779231948430921001363043375685673825855698059480030689975917101070466401843259257811590805972289022532956759475151298140593182308175900093909846542143937799225227957022609340870241248921510460172409017652299938311528895613426515752059559688466140799924608245554535932161187040190587393029507209089591271998513342782057326947637862466367913295657438211309560600630089650073340426537664041345942188008973409531463784021814420766009766465602506883322835948993086486449140101062906166006834188085327235631990339526531113652887514639786898540765806126645129659219719619014187930512701051515926029927090205054142884841473136758297208690909231596907583474793236864251084543067965158581721345726904901153653572385556288237864791226122755432102787059305786295786231275642983910792086078887667555172297128588856784581220621091852427525662224763635276990202303342542314755128799585237101391287955332176610006743513661652552142485261398899068608861528861844349370374694823846427749010701611080527036186070715680555564882608725959575217916814250022247934187051067904276996131102341343524896679787152494792796967330002714403442347507039782017238883350010545734660761015692256058324938105093112059154470232302880811065397783631069922129975630983735537011164009289578393194820642542162578788984913344198140286573442397256710478350485814880154675955691977928161179777400750523871606698749997270828908965462327384179344831647818217387851721023886703320770228121555615847575921487478267136353868601551110699405926006067864290334087727888058925687303576376273919215330017190169373555473325163478820319247014386527016108419917587807663675291308366666842337134144210182873864406114572444018623794890023077565980553387080106398386132185794940984756691974716997391178747896369685970238801804698166595335836337645311413500968369113384235072478981778788697632471427415840660595803465496504866444698796607595040951172071620347936041079300563020961281011683681687902202981613323750373152515529271348058469227323098383097345116864742736487613531920976947737729232208272264719685120200573794452439407955582483301901777748947385942337534698352467408205956575277489921182063859493073555052782556089609656944085709853801716675531325994141162076205478384799485889565590466069550968507945630437600588708935557053228751011341311097786369316896235038474181474698049826056347677690769448953085007678987355301475900416187368050212176068837959115227908910755433693124814490623936844351558616927071139523735922793162375524969423961350214155513068975449113457385326022208696479378423309173905896971714821130421509739370684510313136053365280043303668554832443564996020006515500933982819148647526748656272208320816724214209448284261150691152367993602360278569516879184083222361187309131639211118705910301859840765636562822192401461671281816222023155782273691996167388561452244417388293205475639444024919703027557929058240611399293097254634501660106584993305653380333010602221520572927673003823521");
//        y = Num.squareRoot(x);
//        assertEquals("439913596430685441169964431998845358278626177761807400386816351762788520580386794397407274238636974561620631611721087525193958853477883610882309334737244886313531032220124176989702350094699780096867788611235040446416423882811576054478731135810144301968382613171024288602934447095766253369511622268559812339431724621064318647865277962937674848827626970262323126827618119346904514164772767418489767384253608339116314831451656571192018509364878580197257818404322052815023857961897949339366371455298565837324728278471664801957203634528579924323171058773800298255548427318355828517295550330136505526357286559239206763346174896870612759168762635897515597487034801649755799881914893884581060897886497485477687194932210989454099967030227938558955961922313039319206657615954405175309991544645286093369853232844994970696142122189518879355516271770535641215273830920857077443053167331039881742404664821643302528248948624996548226322556498590635820641430682011296057478333324956499319641795550017851637580998813172637430424057307585303900980944368530815326814593867019128438822286234465399884952156681040985159581552297721518954156026119211622340810421078919802718514488555195078371198243843236440730857726594614205810547635485278331302684663437316337510221937791773981780832138093250310277923676159158660576076145669239496984181828327231240849637561706650531589434181922695584069667093213059002147959298676793142786716955564207427648133661494453615213101489140432036437267394692398745598623603285330026289322374481420630092448838994535323273342556931812227123557900035719946139750637011031135352931127255387236722680691322673867841926951663985626824436460975992928539318617865541912216102082703419242452722793569728747127814581510383698492320348131229756759128445346822803114885981157336580465273961142116447810347764098403264986333971941355243709892407611129061568449615387596190146776517865592155567766576050558243768304605095988639975149759542411368902811213057266093759796420217056901331968972482620432469893186318850941335361666715262932113059940880243766010003328169304455786352612047598444057768308947957349801503246176267710987248266217766610095639894335251311359963425641974358171830314254935286345341700803204356417791060248437931432902585451686040364803366203761764747712526839611891544256253741230579124783597261985029535670013551516010384836721224996192784308738197988802722838676661565258354724734762746706496491564987431215697877876133775997925987304896369572881029720164252726735488842960956337148861860719470709507205585291131289409339953012006774515343242959194256400995500478080009797053100804872870696995980949671438835067522590871609005070248264580201202844765215073525581958235940657300672348848808748778794300377014657729698473336131227836632792242302960568251810492410194751912149630695623133403120345255130133837236739286935227144872786440956579809718182351286969407005432119097896726593040116434593460838425178944566213217184419394841954362080865808947839649615768373268970954053975931244298829432124189504144134140229667811260774972623787963921445024279737141825586387785872789368887382307688123080866198755316153847973180367746704031572881338959754883078319874910698051345763765939011187629606039816536524670365714929804654313689886463876275954290088922646546394230698902755822638435586736518722885456525227046845093260800985257465771624258921854092148033884535821415507017972255149575844182566273420283084032668455333701537188563913424964888534238695091532237090875823772727830016146843046502229995770579621364998073056184155078847428060149983048879402525902048392433082780819438708970773240250940356498262247925313234705516754117542904206853930284937043966976913623199087703920092403971411629495603542758823357771687412382449165032015081359020189301213819492872342029452707997793116769341098539946317440114804938976101020684097540148966358560980795188136515310276520396856618209753221012605849176070413177252132398256408408805745610386681489190093263776030789871576519674472586225263730649415063234621293073425006802748901810152158797570293335054313685814310338348588341531448904365461032247810026254810433166862124666810186496177584144304754411169472699124782723883471528229113873526243016982346568340829462676452801063936762882199104495616044784737315176089056281347694445931838857383167699573738925120542005364653316669752677331899813214146177768333602765644882439328881279587826702103437061619389631422402662618432893192859074078565452022087698216003847652735204491192815631571665612243322133859153144894691429534360141068126353033825604077489082029567807940274189334490976590766340078148074223290913940285039775877548508136666764032619689194962765734717165365674838434969457146877940834334501625328444718152256659905721242145536690683380794997219082118062623819638150043703617396250407406587023601967442043263977419780551568746822363008116199896044282658332020522033600139661427059203730617555465903245545686888560805260231586403044271085906073857479406293886300805153357119189686682573923565222690101378053107404043925993209173239115347868582758512629870712595286100450560803280007984830033410239377576841675915893014501847390814633574881121621647476152304393483891213759743888901383031231958148541714657610663825199822961259585366194455817679022859260213051667584560184482931094625268362789313968452646119789842669668028302240692247962139996834863724358566112159861010777549575549383324019815948953154077920237167579055546668572886313888683606241129252308445013005119676437081111579480164492668839029904795911193438109453568432172520581254438709632433628412224344346019320931756065167406650112382312458773557813664019854497125152003741149078516685830404460464097840168719912875603257812920682949598527005445042809481157215051138671855883054138790984573179689565062465454941044376879912296878869407782687876494224320644039175473837171653722141907575243332886452368669567214078160703825416252820914105635993481541802422565571915797406419360807514752934639595874854667762913204081671524049451308192031637062266930764970192578863831971827113020167337436441429632439616856975159845063785720838741794312309883100146417331614507166106054662225029666432244863698566772393489885611558216095981678910020531141111788776946216966109226435546558446371843534901216152146650758178759291091370365038748838948864791386327702722736931343616010773398606321386917270586081297595212385117403083939266857163080462536624060976885527024137860198722546798765196131238806040954113828796285637875243722065849854692997641753863269676333303237769333493855735064272560331385602803912437709873907790822047667090129312436689943350478178349566768686643570836973327679352825675696439833987278587857039978132804898968358655558579381405371249752295316301218795215594109259037727329434155183386765934415148658344426089089534135113713978413889740293617571308038832901006060389312502231496119284062649599574632338843746767080063877991533910510544092775929058283855684791163007940946336932352464366253627660996357927881136170426300463480559784239766810039028164408548035143654957905864200030153641946113404300685172627938220827130844815664399010297236573811727179193649671298230609834640501165583239175824821067169067634464096374924826023937811994746717050139004475651836664602883497317379448737932555506241786906392440720560439579466713871896389026647735337106050112732506849350620911909172368450465981988397778645535777225476003586803177533571235421537973689105541246095347735208823837340967701322569790122133018427432672701840466026971508521967334125001484868537459943589471953157074766987553587218669417851494908335105034902106394069435446036077150251963004302615978559937870972812807607215260400341459117281953137445587989646464425790330002022818927209545747492972724050962139178682476372649567417443842807383674589260408726491877461702219893441026286504989667111162964756480634402882717835409700974240084738784701630820418540022350693432986303139279278158132776900389616716528068735671921124801017298337366162569191322467418816879397827147913879159358292929473580372859157779522708620863298124318897895955485589257986963564222001211136753025378337295888468589544514407208616966841358150060283445405047946921918920910416705537307759731067234034127316032227052488589959017844887624550776706196926700465077024916613441280210753419059049512714134354756655832028821964324037297940686347095418077462318223310455556754784316174755507018689017671848966238393579069646527688645441238028182725300338613594054706538034571061587821103967501644401889051944400687583784222138908613682042421936772164361285839982188821764336138668255396588867482708420776061984344752291285240480859867653010019272745803602452487108471302784480610532302385844797878455383028673066225003125291600134839263664473556231886673206904740281089375952153447367103966428865289786098503747654900587289889277468886957022805980737074619154728134023971936987987954536488535714554806598290385430329370658625951256948126815445924924407799951090851482310338500180143795270797585444691859402163642847885757414583555300446066462403802563523308065112046970399529938422809110328180592209892545427927177323929684004134870173998263720813560884422890331944801783608385263695453920548397266560917909778672233359506429610941812086978432724023122252335991443307959821863858533990163153671722980186534528804925565180837766449912900931019812856375975701625338941093558751626556255307435950827576702121834239747804944874124862905678200066165914783699310572079349643258234296299362600999035497492248412875917759098658700043580606555311526666712355088991091616851545251791211982010318830495157950178780713148666358554420955589536955843090299429193233389000597241597431870518036505379613971158027765726886347198795203000485164135119938751886798493325640540520643745448536420613226544233230567231392940196136528798728932082055523703787713927718628960765985688515239412020059247549517478129977258353914676817001976856466897174702346357890018737894349526055172749576821786081017478254262193371010956766839275620778734493097936082955051860206196475327496826458337343637576643908839855654483036430908467503336802250755697963107492707389589637475606780668884398756915696257803326376493693675290562867883359109771995749453418155359318654663377405321742088395574409927972964456801264000648855775376772820943079067245762023606882396879238054123773005358429156583910472677423671233304666785744907237353873526026127602099087838213950417639157131378081734060742169861898388350368832726312261735356598864220622072258763836630383588790242600312812095913387692605906027584812735817154170697591247969814888278666924384972638377846091402618698353441285495109696218890831805790589267488069838696806417274321854584428023606341410167667323677137080635743128126355489008298200279983082755986730418255580878766199843835958004779875676761597331075451056673392965236806447944829394348418621120995273091450139355699721215847865344820054995582757985229360918006203858782526885747874359075964229221724795463577833923377140036689762632569815777745620999140013098688638856332808580839127889069850255009087654198539740032093849899569774445811285894883877633945712533505303776180205966661627650531694073755575685357675211082271654695674588806332376836215786950684497177385434047953312736834589295014171426587948986247557303910398800763699131268917202163874191281747389912488552140490494275000686344551508353715017359063108235227574121831821047431235893170786266006037514991729877733718371035914143173689256255661917859368372570437202417658036821140510890253904979450961", y.toString());
    }

    @Test
    void testMod() {
        Num x, y, z;

        x = new Num("123456789");
        y = new Num("4567");
        assertEquals("1645", Num.mod(x, y).toString());

        x = new Num("0");
        y = new Num("4567");
        assertEquals("0", Num.mod(x, y).toString());

        x = new Num("4567");
        y = new Num("0");
        assertEquals(null, Num.mod(x, y));

        x = new Num("123456789123456789123456789123456789123456789");
        y = new Num("123456789");
        assertEquals("0", Num.mod(x, y).toString());

        x = new Num("123456789123456789123456789123456789123456789");
        y = new Num("1234567891");
        assertEquals("781866112", Num.mod(x, y).toString());

        assertEquals(y.toString(), Num.mod(y, x).toString());

        x = new Num("22838422686555587263948685490152318882035472844501809360976087896337614957874991896849190676558796921891771164421806480340889836627951616");
        y = new Num("40159526927620481646000322676629816996929091843685756139806942025541935596108702291164656468513971532274808851070702075958251953125");
        assertEquals("20999033240315721469986534354994417873745732469330316998421948120519852741773482179860166649423259345569288706775360039616901389116", Num.mod(x, y).toString());
    }

    @Test
    void testConvertBase() {
        Num x = new Num(1234);
        Num y = x.convertBase(10);
        assertEquals("1234", y.printNumberByBase());

        y = y.convertBase(16);
        assertEquals("4d2", y.printNumberByBase());

        y = y.convertBase(10);
        assertEquals("1234", y.printNumberByBase());

        y = y.convertBase(8);
        assertEquals("2322", y.printNumberByBase());

        y = y.convertBase(2000);
        y.printNumberByBase();

        y = new Num(3);
        y = y.convertBase(2);
        assertEquals("3", y.toString());
    }

    @Test
    void testInfixToPostfixConversion() {
        String[] expression = {"3", "+", "4"};
        String[] expected = {"3", "4", "+"};
        String[] result = Num.convertInfixToPostfix(expression);
        assertTrue(Arrays.equals(expected, result));

        String[] expression2 = {"3", "+", "4", "*", "2", "/", "(", "1", "-", "5", ")", "^", "2", "^", "3"};
        // extra nulls because otherwise Arrays.equals fails!
        String[] expected2 = {"3", "4", "2", "*", "1", "5", "-", "2", "3", "^", "^", "/", "+"};
        String[] result2 = Num.convertInfixToPostfix(expression2);
        assertTrue(Arrays.equals(expected2, result2));

        String[] expression3 = {"(", "(", "3", "+", "5", ")", "-", "(", "4", "+", "5", ")", ")", "^", "2"};
        String[] expected3 = {"3", "5", "+", "4", "5", "+", "-", "2", "^"};
        String[] result3 = Num.convertInfixToPostfix(expression3);
        assertTrue(Arrays.equals(expected3, result3));
    }

    @Test
    void testInfixEvaluation() {
        String expectedString;
        String[] expression1 = {"0", "+", "0"};
        Num expected = new Num("0");
        Num result = Num.evaluateInfix(expression1);
        assertEquals(0, expected.compareTo(result));

        String[] expression2 = {"(", "(", "1", "+", "2", ")", "-", "3", ")", "-", "(", "4", "-", "5", ")"};
        expected = new Num(1);
        result = Num.evaluateInfix(expression2);
        assertEquals(0, result.compareTo(expected));

        String[] expression3 = {"2985984", "*", "1336336"};
        expected = new Num("3990277914624");
        result = Num.evaluateInfix(expression3);
        assertEquals(0, result.compareTo(expected));

        String[] expression4 = {"(", "(", "4568", "+", "7937", ")", "*", "(", "543", "+", "787", ")", ")", "^", "2"};
        expectedString = "276611781722500";
        result = Num.evaluateInfix(expression4);
        assertEquals(expectedString, result.toString());

        String[] expression5 = {"(", "(", "(", "(", "4568", "+", "7937", ")", "*", "(", "543", "+", "787", ")", ")", "^", "2", ")", "+", "(", "45", "^", "100", ")", ")"};
        expectedString = "2095324917039863304313251555826661356467173660585553096278749223514308239748113453774362345525549271530430449123445790860832162183502447305727400816977300690150863125";
        result = Num.evaluateInfix(expression5);
        assertEquals(expectedString, result.toString());

        String[] expression6 = {"(", "(", "(", "(", "4568", "+", "7937", ")", "*", "(", "543", "+", "787", ")", ")", "^", "2", ")", "*", "(", "45", "^", "100", ")", ")"};
        expectedString = "579591558589946089163934732124557974181023604338392314604791407230056195168788357056599510887136359643494310909402228558657891420610697944676426018872916756663471460342407226562500";
        result = Num.evaluateInfix(expression6);
        assertEquals(expectedString, result.toString());

        String[] expression7 = {"59", "^", "189"};
        expectedString = "49094201453858898563821909815715622898343840788307951790829058306066965277556690405198923330469181360047995792298590858320216851893709568850014603801957662304461999764512417471232096405932793406544518843353616811565660050247958484009364202138555194392211155816447162261055429393099785346263362040737435671744070513242674679684447717739";
        result = Num.evaluateInfix(expression7);
        assertEquals(expectedString, result.toString());

        String[] expression8 = {"15", "+", "15", "^", "2"};
        expectedString = "240";
        result = Num.evaluateInfix(expression8);
        assertEquals(expectedString, result.toString());

        String[] expression9 = {"91", "%", "2"};
        expectedString = "1";
        result = Num.evaluateInfix(expression9);
        assertEquals(expectedString, result.toString());
    }

    @Test
    void infixEvaluationFailures() {
        String[] expression1 = {"(", "9", "+", "10"};
        assertThrows(EmptyStackException.class, () -> {
            Num.evaluateInfix(expression1);
        });

        String[] expression2 = {};
        assertThrows(ArithmeticException.class, () -> {
            Num.evaluateInfix(expression2);
        });

        String[] expression3 = {"(", "(", "(", "(", "4568", "+", "7937", ")", "*", "(", "543", "+", "787", ")", ")", "^", "2", ")", "*", "45", "^", "100", ")", ")"};
        assertThrows(NoSuchElementException.class, () -> {
            Num.evaluateInfix(expression3);
        });
    }
}